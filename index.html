<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duck Ponds Property | Francis Marion University</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-primary: #193a80;
            --color-primary-dark: #003364;
            --color-primary-light: #2a4a90;
            --color-sand: #e3ddcd;
            --color-accent: #e02828;
            --color-text: #444141;
            --color-text-light: #666666;
            --font-heading: 'Libre Baskerville', Georgia, serif;
            --font-body: 'Source Sans 3', -apple-system, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            font-family: var(--font-body);
            color: var(--color-text);
            background: var(--color-primary-dark);
        }
        
        #map {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 380px;
            max-height: calc(100vh - 40px);
            background: var(--color-sand);
            border-radius: 8px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.25);
            z-index: 1000;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .panel-header {
            background: var(--color-primary);
            color: white;
            padding: 24px;
            position: relative;
        }
        
        .panel-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 24px;
            right: 24px;
            height: 3px;
            background: var(--color-accent);
        }
        
        .panel-header h1 {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: -0.01em;
        }
        
        .panel-content {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        .section {
            margin-bottom: 20px;
        }
        
        .section h2 {
            font-family: var(--font-heading);
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 10px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .section p {
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--color-text);
        }
        
        .section ul {
            font-size: 0.95rem;
            line-height: 1.7;
            padding-left: 20px;
            color: var(--color-text);
        }
        
        .section li {
            margin-bottom: 4px;
        }

        .panel-footer {
            padding: 16px 24px;
            background: rgba(0,0,0,0.03);
            border-top: 1px solid rgba(0,0,0,0.08);
            font-size: 0.8rem;
            color: var(--color-text-light);
        }
        
        .panel-footer a {
            color: var(--color-accent);
            text-decoration: none;
        }
        
        .panel-footer a:hover {
            text-decoration: underline;
        }
        
        .toggle-btn {
            display: none;
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 6px;
            font-family: var(--font-body);
            font-size: 0.9rem;
            cursor: pointer;
            box-shadow: 0 2px 12px rgba(0,0,0,0.2);
        }
        
        .toggle-btn:hover {
            background: var(--color-primary-light);
        }
        
        /* Leaflet control styling */
        .leaflet-control-zoom {
            border: none !important;
            box-shadow: 0 2px 12px rgba(0,0,0,0.15) !important;
        }
        
        .leaflet-control-zoom a {
            background: var(--color-sand) !important;
            color: var(--color-primary) !important;
            border: none !important;
        }
        
        .leaflet-control-zoom a:hover {
            background: white !important;
        }
        
        /* Legend */
        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--color-sand);
            padding: 12px 16px;
            border-radius: 6px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            font-size: 0.85rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-color {
            width: 20px;
            height: 12px;
            border: 2px solid;
            border-radius: 2px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .info-panel {
                width: calc(100% - 40px);
                max-height: 50vh;
                top: auto;
                bottom: 20px;
                transition: transform 0.3s ease;
            }
            
            .info-panel.collapsed {
                transform: translateY(calc(100% - 60px));
            }
            
            .toggle-btn {
                display: block;
            }
            
            .info-panel.collapsed ~ .toggle-btn {
                bottom: calc(50vh + 30px);
                top: auto;
            }
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="info-panel" id="infoPanel">
        <div class="panel-header">
            <h1>Duck Ponds Property</h1>
        </div>
        
        <div class="panel-content">
            <div class="section">
                <h2>About the Property</h2>
                <p>The 8,460-acre Duck Ponds property is located along 8 miles of the Great Pee Dee River in Florence and Darlington Counties and just 15 minutes from Francis Marion University's main campus. The property will serve as the primary field site for FMU's new forestry program launching in August 2026.</p>
            </div>
            
            <div class="section">
                <h2>Land Composition</h2>
                <ul>
                    <li>Bottomland hardwood forests</li>
                    <li>Mixed upland pine</li>
                    <li>Wetlands and riparian zones</li>
                </ul>
            </div>
            
            <div class="section">
                <h2>Conservation Partners</h2>
                <p>This acquisition was made possible through a partnership including the Open Space Institute, Florence County, SC Office of Resilience, SC Conservation Bank, and the Darla Moore Foundation.</p>
            </div>
            
            <div class="section">
                <h2>Public Access</h2>
                <p>Similar to FMU's Freshwater Ecology Center, the property will be used for student labs and research while offering public access on designated days.</p>
            </div>
        </div>
        
        <div class="panel-footer">
            Learn more at <a href="https://www.fmarion.edu" target="_blank">fmarion.edu</a>
        </div>
    </div>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="border-color: #e02828; background: rgba(224, 40, 40, 0.25);"></div>
            <span>Duck Ponds</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="border-color: #4a90d9; background: rgba(74, 144, 217, 0.3);"></div>
            <span>FMU Main Campus</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="border-color: #50c878; background: rgba(80, 200, 120, 0.3);"></div>
            <span>Freshwater Ecology Center</span>
        </div>
    </div>
    
    <button class="toggle-btn" id="toggleBtn">☰ Property Info</button>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <script>
        // Initialize the map
        const map = L.map('map', {
            zoomControl: false  // Disable default position
        });

        // Add zoom control to bottom-right to avoid info panel
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);
        
        // Add ESRI World Imagery basemap
        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles © Esri — Source: Esri, Maxar, Earthstar Geographics, and the GIS User Community',
            maxZoom: 19
        }).addTo(map);
        
        // Boundary styles
        const styles = {
            duckPonds: {
                color: '#e02828',
                weight: 3,
                opacity: 1,
                fillColor: '#e02828',
                fillOpacity: 0.15
            },
            fmu: {
                color: '#4a90d9',
                weight: 3,
                opacity: 1,
                fillColor: '#4a90d9',
                fillOpacity: 0.2
            },
            fec: {
                color: '#50c878',
                weight: 3,
                opacity: 1,
                fillColor: '#50c878',
                fillOpacity: 0.2
            }
        };

        // Load all boundary files
        const boundaryFiles = [
            { url: 'DuckPondsBoundary.geojson', style: styles.duckPonds },
            { url: 'FMUBoundary.geojson', style: styles.fmu },
            { url: 'FECBoundary.geojson', style: styles.fec }
        ];

        // Create a feature group to hold all boundaries
        const allBoundaries = L.featureGroup().addTo(map);

        // Load each boundary file
        Promise.all(boundaryFiles.map(file =>
            fetch(file.url)
                .then(response => response.json())
                .then(data => {
                    if (data.crs) delete data.crs;
                    return { data, style: file.style };
                })
        ))
        .then(results => {
            results.forEach(({ data, style }) => {
                L.geoJSON(data, {
                    style: style,
                    onEachFeature: function(feature, layer) {
                        if (feature.properties && feature.properties.Name) {
                            layer.bindPopup('<strong>' + feature.properties.Name + '</strong>');
                        }
                    }
                }).addTo(allBoundaries);
            });

            // Fit map to show all boundaries, accounting for info panel on left
            map.fitBounds(allBoundaries.getBounds(), {
                paddingTopLeft: [420, 50],
                paddingBottomRight: [50, 50]
            });
        })
        .catch(error => {
            console.error('Error loading boundaries:', error);
            map.setView([34.29, -79.62], 12);
        });
        
        // Mobile toggle functionality
        const toggleBtn = document.getElementById('toggleBtn');
        const infoPanel = document.getElementById('infoPanel');
        
        toggleBtn.addEventListener('click', function() {
            infoPanel.classList.toggle('collapsed');
        });
    </script>
</body>
</html>
